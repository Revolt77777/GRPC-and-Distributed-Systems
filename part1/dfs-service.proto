syntax = "proto3";

package dfs_service;

service DFSService {
    rpc StoreFile (stream StoreChunk) returns (StoreResponse);
    rpc FetchFile (FetchRequest) returns (stream FetchChunk);
    rpc DeleteFile (DeleteRequest) returns (DeleteResponse);
    rpc ListFiles (ListFilesRequest) returns (FilesList);
    rpc GetFileStatus (GetFileStatusRequest) returns (FileStatus);
}
// Data Chunk for store operation
message StoreChunk {
    string filename = 1;
    bytes data = 2;
}
// Response for store operation
message StoreResponse {
    string filename = 1;
    int64 mtime = 2;
}

// Request for fetch operation
message FetchRequest {
    string filename = 1;
}

// Data Chunk for fetch operation
message FetchChunk {
    bytes data = 1;
}

// Request for delete operation
message DeleteRequest {
    string filename = 1;
}

// Response for delete operation
message DeleteResponse {
    string filename = 1;
}

// Request for get status operation
message GetFileStatusRequest {
    string filename = 1;
}

// Status for single file
message FileStatus{
    string filename = 1;
    int64 filesize = 2;
    int64 mtime = 3;
}

// Request for list all files
message ListFilesRequest {
}

// Response for list all files - files list
message FilesList {
    repeated FileStatus file = 1;
}